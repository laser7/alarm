<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
 <!--<link rel="stylesheet" href="style.css">-->   
    <title>My Alarm Clock</title>
    <script src="https://vuejs.org/js/vue.js"></script>
</head>
<body >
    <div id="app" >

        <!--current time-->
        <section>
            <h1>Clock</h1>
            <p>{{clock.time}}</p>
            <p>{{clock.text}}</p>
        </section>

        <section class="section_one">
            <!-- https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/time -->
            <!-- https://vuejs.org/v2/api/#v-model -->
            <input class="time_input" type="time" step="1" v-model="timer" required @keyup="showfirst($event)" ref="time">
            <input class="add_button" type="submit" value="Add Timer" @click="addTimer" @keyup="show($event)" ref="add">
           
        </section>

        <section class="section_two">

                <audio src="http://onj3.andrelouis.com/phonetones/unzipped/Palm-Treo800W/Alarm5.wav" preload="auto" id="Ton: Beeper"></audio>
                <audio src="http://www.mountaincharlie1850.org/sounds/homer_snicker.wav" preload="auto" id="Ton: Simpsonlaugh"></audio>
                <audio src="http://dight310.byu.edu/media/audio/FreeLoops.com/5/5/Ocean%20Storm.wav-19044-Free-Loops.com.mp3"  preload="auto" id="Ton: Ocean"></audio>
                <audio src="http://www.alaska.net/~chrisaue/assets/multimedia/web_jungle.wav" preload="auto" id="Ton: Jungle"></audio>
                <audio src="http://jp.popapostle.com/sounds/JP/roar.wav" preload="auto" id="Ton: Jurassic Park"></audio>



                <select v-model="selected" class="ton_select" @keyup="showselect($event)" ref="select">
                        <option selected> Ton: Beeper</option>
                        <option> Ton: Simpsonlaugh</option>
                        <option> Ton: Ocean </option>
                        <option> Ton: Jungle </option>
                        <option> Ton: Jurassic Park </option>
        
                    </select>
                  <!--<span>Selected: {{selected}}</span>-->  
        </section>

        <section>
            <ul class="li_list" >
                <!-- https://vuejs.org/v2/guide/list.html#v-for-with-a-Range -->
               <li  class ="delete_button" v-for="(item, index) of list" key="item.id">
                   {{item.time}} {{item.ton}} 
                   <button  ref="delete" @click = "buttonDelete(index)" @keyup =" showdelete($event)">Delete timer</button> 
                </li>
               
            </ul>
        </section>

    </div>
</body>
<script>
    new Vue({
        el: "#app",
        data: {
            clock: {
                time: "14:15:00",
                interval: null,
                text:'come to update'
            },
            timer: null,
            //{ time: "13:25:00", interval: null}, { time: "13:35:00", interval: null}
            list: [],
            selected: null,
            
          
        },
        mounted() {
            this.clock.interval = setInterval(this.updateTime,1000);
            this.clock.text = setInterval(this.alarm,1000);
            this.timer = "10:15";
            this.$refs.time.focus();
            

          
        },
        beforeDestroy () {
            clearInterval(this.clock.interval);
          
        },

        methods: {
            updateTime() {
                const now = new Date();
                const hours = now.getHours();
                const minutes = now.getMinutes();

                const seconds = now.getSeconds();
                if(seconds<10){
                    this.clock.time = hours+':' +minutes+':'+'0'+seconds;
                }else if(hours<10){
                    this.clock.time = '0'+hours+':' +minutes+':'+seconds;
                }else if(minutes<10){
                    this.clock.time = hours+':' +'0'+minutes+':'+seconds;
                }else{
                // Template String
               // this.clock.time = `${hours}:${minutes}:${seconds}`;
               this.clock.time = hours+':' +minutes+':'+seconds;
                }
            },
            addTimer() {
                console.log("addTimer");
                // console.log(this.timer);
                const mTime = this.timer;
                const mInterval = 1;
                const mTon = this.selected;
        
                // const mInterval = setInterval(this.alarm, 5000);
                this.list.push({ time: mTime, interval: mInterval, ton:mTon});

            },
            alarm() {
               // alert("Attention!");
               if(this.timer==this.clock.time){
                    this.clock.text='the time is up!';
                    if(this.selected!=''){
                let audio=document.getElementById(this.selected);
                audio.play();
            }

                }else{
                    this.clock.text= '';
                }
            },
            buttonDelete(index){
               
                const mTime = this.timer;
                alert("the timer on "+this.timer+ " will be deleted");
                const mInterval = 1;
      
   
                this.list.splice(index, 1);
            },
            showall:function(ev){
                if(ev.keyCode == 39){
                    this,$refs.time.focus();
                }
            },
            showfirst:function(ev){
                if(ev.keyCode==39){
                    
                    this.$refs.add.focus();
                }else if(ev.keyCode == 37){
                    this.$refs.delete.focus();
                }
            },
            show:function(ev){
                        if(ev.keyCode == 13){
                      
                          //  addTimer();
                        }else if(ev.keyCode == 37){
                           
                       
                            this.$refs.time.focus();
                     
                        }else if(ev.keyCode == 39){
                            
                            this.$refs.select.focus();
                        }
                    },
            showdelete:function(ev){
                        if(ev.keyCode == 13){
                        
                        //    buttonDelete();
                        }else if(ev.keyCode == 37){
                            this.$refs.select.focus();
                        }else if(ev.keyCode == 39){
                            this.$refs.time.focus();
                        }
                    },
            showselect:function(ev){
                if(ev.keyCode == 13){
                            alert('selected');
                           
                        }else if(ev.keyCode == 37){
                            this.$refs.add.focus();
                        }else if(ev.keyCode == 39){
                            this.$refs.delete.focus();
                            
                        }
            }



        }
    });
</script>
</html>